function subscribeCollection(a){var b=firebase.firestore(firebaseApp);if(b){var c=b.collection(a);c?($("#comment-realtime-error").html(""),$("#comment-realtime-error").hide()):($("#comment-realtime-error").html("Error in loading realtime comments. Please refresh the page."),$("#comment-realtime-error").show());const d=countFunctionInvocation(handleCommentSubscription,1);c.onSnapshot(d)}}function handleCommentSubscription(a){a.docChanges().forEach(function(a){if(a.type==="added"){var b=a.doc.data(),c=b.data,d=c.comment_id,e=c.parent_id,f=c.is_first_child,g=c.username,h=c.html,i=c.ctype_id,j=c.object_pk,k=$("#username").text(),l=$("#is-superuser").length,m=$("#is-event-admin").length;if(g!=k){addComment(d,e,h,i,j,f);var n=$("#c"+d+" .edit-link");n.remove()}if(g!=k&&!l&&!m)try{var o=$("#c"+d+" .delete-link");o.remove()}catch(p){console.log(p)}else if(g==k)try{var q=$("#c"+d+" .private-message-link");q.remove()}catch(p){console.log(p)}}if(a.type==="modified"){var b=a.doc.data(),c=b.data,r=b.event;if(r==="comment_edited"){var d=c.comment_id,g=c.username,h=c.html,i=c.ctype_id,j=c.object_pk;$("#comment-container-"+d).replaceWith(h);var k=$("#username").text(),l=$("#is-superuser").length,m=$("#is-event-admin").length;if(g!=k){var n=$("#c"+d+" .edit-link");n.remove()}if(g!=k&&!l&&!m)try{var o=$("#c"+d+" .delete-link");o.remove()}catch(p){console.log(p)}else if(g==k)try{var q=$("#c"+d+" .private-message-link");q.remove()}catch(p){console.log(p)}}if(r==="comment_deleted"){var d=c.comment_id,s=c.root_comment_id,t=c.root_child_exists,i=c.ctype_id,j=c.object_pk;removeComment(d,s,t,i,j)}}})}function countFunctionInvocation(a,b){var c=0;return function(d){return c++,c<=b?!0:a(d,c)}};